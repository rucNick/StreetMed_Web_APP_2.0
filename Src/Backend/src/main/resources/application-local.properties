# Local Development Configuration with Proper TLS Enforcement
spring.application.name=StreetMed_Backend
server.address=0.0.0.0
server.shutdown=graceful

# ============================================
# TLS/SSL Configuration
# ============================================
# Enable TLS
server.ssl.enabled=true


# HTTPS Port
server.port=8443

# HTTP Port (for dual-port mode)
server.http.port=8080



# Keystore Configuration
server.ssl.key-store=classpath:keystore/streetmed-keystore.p12
server.ssl.key-store-type=PKCS12
server.ssl.key-store-password=streetmed123
server.ssl.key-alias=streetmed

# TLS Protocol Configuration
server.ssl.protocol=TLS
server.ssl.enabled-protocols=TLSv1.2,TLSv1.3

# Custom TLS Configuration
tls.force.https=false
tls.dual.port.enabled=true

# ============================================
# ADMIN SECURITY ENFORCEMENT
# ============================================
# Enforce HTTPS for admin endpoints
tls.enforce.admin=true
tls.allow.http.in.dev=true

# ============================================

# Certificate Generation Properties (for KeystoreGenerator)
tls.keystore.path=src/main/resources/keystore/streetmed-keystore.p12
tls.keystore.password=streetmed123
tls.key.alias=streetmed
tls.key.size=2048
tls.validity.days=365
tls.common.name=localhost
tls.organization=StreetMed@Pitt
tls.organization.unit=Development
tls.locality=Pittsburgh
tls.state=PA
tls.country=US

# Exclude auto-configurations for unused dependencies
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.cassandra.CassandraAutoConfiguration,org.springframework.boot.autoconfigure.data.cassandra.CassandraDataAutoConfiguration,org.springframework.boot.autoconfigure.web.reactive.function.client.WebClientAutoConfiguration

# Session Configuration
spring.session.timeout=30m
server.servlet.session.timeout=30m
# secure cookies
server.servlet.session.cookie.secure=true
server.servlet.session.cookie.http-only=true

# Local MySQL Database Configuration
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
spring.datasource.url=jdbc:mysql://localhost:3306/streetmed?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true&createDatabaseIfNotExist=true
spring.datasource.username=streetmed_user
spring.datasource.password=streetmed_password

# CORS configuration for local development (updated for HTTPS)
cors.allowed-origins=http://localhost:3000,https://localhost:3000,http://127.0.0.1:3000,https://127.0.0.1:3000

# Hikari Connection Pool Configuration (optimized for local development)
spring.datasource.hikari.pool-name=LocalMySQLHikariCP
spring.datasource.hikari.minimum-idle=2
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.validation-timeout=5000
spring.datasource.hikari.max-lifetime=1200000
spring.datasource.hikari.auto-commit=true
spring.datasource.hikari.connection-test-query=SELECT 1
spring.datasource.hikari.leak-detection-threshold=60000

# JPA Configuration for MySQL
spring.jpa.database-platform=org.hibernate.dialect.MySQLDialect
spring.jpa.show-sql=true
spring.jpa.hibernate.ddl-auto=update
spring.jpa.open-in-view=false
spring.jpa.properties.hibernate.format_sql=true

# Enable SQL logging for development
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.orm.jdbc.bind=TRACE
logging.level.org.hibernate.orm.connections.pooling=WARN

# TLS/SSL Debug Logging
logging.level.com.backend.streetmed_backend.config.TLSConfig=DEBUG
logging.level.com.backend.streetmed_backend.util.KeystoreGenerator=DEBUG
logging.level.com.backend.streetmed_backend.controller.Test.TLSTestController=DEBUG
logging.level.com.backend.streetmed_backend.controller.Auth.AdminController=DEBUG
logging.level.org.apache.coyote.http11=DEBUG
logging.level.org.apache.tomcat=INFO

# Transaction Configuration
spring.jpa.properties.hibernate.current_session_context_class=thread

# Multithreading Configuration
spring.task.execution.pool.core-size=4
spring.task.execution.pool.max-size=8
spring.task.execution.pool.queue-capacity=100
spring.task.execution.thread-name-prefix=StreetMed-Task-
spring.task.execution.shutdown.await-termination=true
spring.task.execution.shutdown.await-termination-period=20s

# Graceful Shutdown
spring.lifecycle.timeout-per-shutdown-phase=20s

# Swagger UI path
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.api-docs.path=/api-docs

# Local MongoDB Configuration
spring.data.mongodb.uri=mongodb://localhost:27017/streetmed
spring.data.mongodb.database=streetmed

# File upload settings
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB

# Email Configuration
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=streetmedgo@gmail.com
spring.mail.password=zmcjlhadinbhddfe
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true

# Client Authentication Configuration
security.client.authentication.key=street-med-client-authentication-key
security.client.validation.relaxed=true

# Security Configuration
security.use.custom.encryption=true
auth.dev.token.enabled=true
